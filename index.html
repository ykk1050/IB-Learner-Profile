<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IB í•™ìŠµììƒ ì§„ë‹¨ í…ŒìŠ¤íŠ¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        .hidden {
            display: none;
        }

        h1 {
            color: #667eea;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.2em;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .info-box {
            background: #f0f4ff;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .info-box ul {
            list-style: none;
            padding-left: 0;
        }

        .info-box li {
            padding: 8px 0;
            color: #555;
        }

        .info-box li:before {
            content: "â€¢ ";
            color: #667eea;
            font-weight: bold;
        }

        .btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .progress-container {
            margin-bottom: 30px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
            color: #666;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }

        .question-box {
            margin: 30px 0;
        }

        .question-text {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .answer-btn {
            padding: 20px;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .answer-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .answer-btn.option-5 { border-color: #667eea; }
        .answer-btn.option-5:hover { background: #f0f4ff; border-color: #667eea; }

        .answer-btn.option-4 { border-color: #60a5fa; }
        .answer-btn.option-4:hover { background: #eff6ff; border-color: #60a5fa; }

        .answer-btn.option-3 { border-color: #9ca3af; }
        .answer-btn.option-3:hover { background: #f9fafb; border-color: #9ca3af; }

        .answer-btn.option-2 { border-color: #fb923c; }
        .answer-btn.option-2:hover { background: #fff7ed; border-color: #fb923c; }

        .answer-btn.option-1 { border-color: #ef4444; }
        .answer-btn.option-1:hover { background: #fef2f2; border-color: #ef4444; }

        .result-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            color: white;
        }

        .top-profile {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 3px solid #667eea;
        }

        .profile-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .medal {
            font-size: 3em;
        }

        .profile-name {
            font-size: 1.3em;
            font-weight: 700;
            color: #333;
        }

        .profile-name-en {
            font-size: 0.9em;
            color: #666;
        }

        .profile-score {
            text-align: right;
        }

        .score-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
        }

        .score-label {
            font-size: 0.9em;
            color: #666;
        }

        .all-scores {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .score-item {
            margin-bottom: 20px;
        }

        .score-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .score-bar-container {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .score-bar {
            height: 100%;
            background: #667eea;
            transition: width 0.5s;
        }

        .button-group {
            display: flex;
            gap: 15px;
        }

        .btn-secondary {
            flex: 1;
            background: white;
            color: #667eea;
            border: 3px solid #667eea;
        }

        .btn-secondary:hover {
            background: #f0f4ff;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 2em;
            }

            .question-text {
                font-size: 1.2em;
            }

            .button-group {
                flex-direction: column;
            }
        }

        .profile-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9em;
        }
        .profile-table th, .profile-table td {
            border: 1px solid #e0e0e0;
            padding: 10px;
            text-align: center;
        }
        .profile-table th {
            background: #f0f4ff;
            color: #667eea;
            font-weight: 600;
        }
        .profile-table tr:nth-child(even) {
            background: #fafafa;
        }
        .intro-description {
            text-align: center;
            color: #555;
            margin-bottom: 20px;
            line-height: 1.6;
            word-break: keep-all;
            font-weight: 600;
        }
        
        .ibti-result-box {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 25px;
            color: white;
            box-shadow: 0 10px 20px rgba(253, 160, 133, 0.3);
        }
        
        .ibti-code {
            font-size: 3.5em;
            font-weight: 800;
            letter-spacing: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin: 10px 0;
        }

        .dev-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #e0e0e0;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
            color: #666;
            font-weight: 600;
        }
        .dev-btn:hover {
            background: #fff;
            color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.15);
        }

        /* ê²°ê³¼ ì¡°íšŒ ëª¨ë‹¬ */
        .search-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s;
        }

        .search-modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px; /* ë„ˆë¹„ ì¦ê°€ */
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            position: relative;
            animation: slideIn 0.3s;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-search {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-search:hover {
            color: #333;
        }

        /* ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ ìŠ¤íƒ€ì¼ */
        .search-result-list {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
            display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
        }

        .search-result-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-result-item:hover {
            background: #eef2ff;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .result-date {
            font-weight: 600;
            color: #333;
        }

        .result-type {
            font-size: 0.9em;
            color: #666;
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 12px;
            margin-left: 10px;
        }

        .result-arrow {
            color: #667eea;
            font-weight: bold;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>
    <button id="search-history-btn" class="dev-btn">ğŸ” ë‚´ ê²°ê³¼ ì°¾ê¸°</button>
    
    <!-- ê²°ê³¼ ì¡°íšŒ ëª¨ë‹¬ -->
    <div id="search-modal" class="search-modal">
        <div class="search-modal-content">
            <span class="close-search">&times;</span>
            <h2 style="text-align: center; color: #667eea; margin-bottom: 20px;">ğŸ“‹ ì§€ë‚œ ê²€ì‚¬ ê²°ê³¼ ì¡°íšŒ</h2>
            <p style="text-align: center; color: #666; margin-bottom: 20px; font-size: 0.9em;">
                ì´ì „ì— ì§„í–‰í–ˆë˜ ê²€ì‚¬ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.<br>ì •ë³´ë¥¼ ì •í™•í•˜ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.
            </p>
            
            <div class="input-group">
                <label for="search-name">ì´ë¦„</label>
                <input type="text" id="search-name" placeholder="ì´ë¦„ ì…ë ¥">
            </div>
            <div class="input-group">
                <label for="search-grade">í•™ë…„</label>
                <input type="text" id="search-grade" placeholder="ì˜ˆ: 3, 4, 5, 6">
            </div>
            <div class="input-group">
                <label for="search-class">ë°˜</label>
                <input type="text" id="search-class" placeholder="ì˜ˆ: 1, 2, 3">
            </div>
            <div class="input-group">
                <label for="search-number">ë²ˆí˜¸</label>
                <input type="text" id="search-number" placeholder="ì˜ˆ: 1, 2, 3">
            </div>
            
            <button class="btn btn-primary" id="do-search-btn">ê²°ê³¼ ë¶ˆëŸ¬ì˜¤ê¸°</button>

            <!-- ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ ì˜ì—­ -->
            <div id="search-result-area" class="search-result-list">
                <h3 style="color: #667eea; margin-bottom: 15px; font-size: 1.1em;">ğŸ“‹ ê²€ì‚¬ ê¸°ë¡ ëª©ë¡</h3>
                <div id="search-list-container"></div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- ì¸íŠ¸ë¡œ í™”ë©´ -->
        <div id="intro-screen">
            <h1>ğŸŒŸ IBTI ì§„ë‹¨</h1>
            <p class="subtitle">ë‚˜ëŠ” ì–´ë–¤ IB í•™ìŠµììƒì— ê°€ê¹Œìš¸ê¹Œ?</p>

            <div class="intro-description">
                <p>ê²€ì‚¬ë¥¼ ëë‚´ê³  ë‚˜ë©´ MBTIí…ŒìŠ¤íŠ¸ ì²˜ëŸ¼ ë‚˜ë§Œì˜ IBTIê°€ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤!<br>ì—´ì‹¬íˆ ì°¸ì—¬í•˜ê³  ì¹œêµ¬ë“¤ê³¼ ë¹„êµí•˜ë©° ì´ì•¼ê¸°í•´ë´…ì‹œë‹¤!</p>
            </div>

            <table class="profile-table">
                <thead>
                    <tr>
                        <th>í•™ìŠµììƒ</th>
                        <th>ì˜ì–´ ì´ë¦„</th>
                        <th>ì•ŒíŒŒë²³</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>íƒêµ¬í•˜ëŠ” ì‚¬ëŒ</td><td><span style="color: #E91E63; font-weight: bold;">I</span>nquirers</td><td><span style="color: #E91E63; font-weight: bold;">I</span></td></tr>
                    <tr><td>ì§€ì‹ì´ í’ë¶€í•œ ì‚¬ëŒ</td><td><span style="color: #9C27B0; font-weight: bold;">K</span>nowledgeable</td><td><span style="color: #9C27B0; font-weight: bold;">K</span></td></tr>
                    <tr><td>ì‚¬ê³  í•˜ëŠ” ì‚¬ëŒ</td><td><span style="color: #2196F3; font-weight: bold;">T</span>hinkers</td><td><span style="color: #2196F3; font-weight: bold;">T</span></td></tr>
                    <tr><td>ì†Œí†µí•˜ëŠ” ì‚¬ëŒ</td><td>Co<span style="color: #00BCD4; font-weight: bold;">M</span>municators</td><td><span style="color: #00BCD4; font-weight: bold;">M</span></td></tr>
                    <tr><td>ì›ì¹™ì„ ì§€í‚¤ëŠ” ì‚¬ëŒ</td><td><span style="color: #009688; font-weight: bold;">P</span>rincipled</td><td><span style="color: #009688; font-weight: bold;">P</span></td></tr>
                    <tr><td>ì—´ë¦° ë§ˆìŒì„ ê°€ì§„ ì‚¬ëŒ</td><td><span style="color: #4CAF50; font-weight: bold;">O</span>pen-minded</td><td><span style="color: #4CAF50; font-weight: bold;">O</span></td></tr>
                    <tr><td>ë°°ë ¤í•˜ëŠ” ì‚¬ëŒ</td><td><span style="color: #8BC34A; font-weight: bold;">C</span>aring</td><td><span style="color: #8BC34A; font-weight: bold;">C</span></td></tr>
                    <tr><td>ë„ì „í•˜ëŠ” ì‚¬ëŒ</td><td><span style="color: #FF9800; font-weight: bold;">R</span>isk-takers</td><td><span style="color: #FF9800; font-weight: bold;">R</span></td></tr>
                    <tr><td>ê· í˜• ì¡íŒ ì‚¬ëŒ</td><td><span style="color: #FF5722; font-weight: bold;">B</span>alanced</td><td><span style="color: #FF5722; font-weight: bold;">B</span></td></tr>
                    <tr><td>ì„±ì°°í•˜ëŠ” ì‚¬ëŒ</td><td>Re<span style="color: #2979FF; font-weight: bold;">F</span>lective</td><td><span style="color: #2979FF; font-weight: bold;">F</span></td></tr>
                </tbody>
            </table>

            <div class="input-group" style="background: #f8f9fa; padding: 20px; border-radius: 15px; border: 2px solid #e9ecef;">
                <label style="text-align: center; margin-bottom: 15px; font-size: 1.1em; color: #667eea;">ğŸ“ ê²€ì‚¬ ìœ í˜• ì„ íƒ</label>
                <div style="display: flex; justify-content: center; gap: 30px;">
                    <label style="cursor: pointer; display: flex; align-items: center; gap: 8px; padding: 10px; border-radius: 8px; transition: background 0.2s;">
                        <input type="radio" name="test-type" value="50" style="width: 20px; height: 20px;">
                        <span style="font-size: 1.1em;">50ë¬¸í•­ (ì•½ì‹)</span>
                    </label>
                    <label style="cursor: pointer; display: flex; align-items: center; gap: 8px; padding: 10px; border-radius: 8px; transition: background 0.2s;">
                        <input type="radio" name="test-type" value="100" checked style="width: 20px; height: 20px;">
                        <span style="font-size: 1.1em;">100ë¬¸í•­ (ì •ë°€)</span>
                    </label>
                </div>
                <p style="text-align: center; color: #666; font-size: 0.9em; margin-top: 10px;">
                    * 50ë¬¸í•­: ì•½ 10ë¶„ ì†Œìš” / 100ë¬¸í•­: ì•½ 20ë¶„ ì†Œìš”
                </p>
            </div>

            <div class="input-group">
                <label for="student-name">ì´ë¦„</label>
                <input type="text" id="student-name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>

            <div class="input-group">
                <label for="student-grade">í•™ë…„</label>
                <input type="text" id="student-grade" placeholder="ì˜ˆ: 3, 4, 5, 6">
            </div>

            <div class="input-group">
                <label for="student-class">ë°˜</label>
                <input type="text" id="student-class" placeholder="ì˜ˆ: 1, 2, 3">
            </div>

            <div class="input-group">
                <label for="student-number">ë²ˆí˜¸</label>
                <input type="text" id="student-number" placeholder="ì˜ˆ: 1, 2, 3">
            </div>

            <div class="info-box">
                <h3>ğŸ“‹ í…ŒìŠ¤íŠ¸ ì•ˆë‚´</h3>
                <ul>
                    <li>ì´ 100ê°œì˜ ì§ˆë¬¸ì— ë‹µí•˜ê²Œ ë©ë‹ˆë‹¤</li>
                    <li>ê° ì§ˆë¬¸ì— ëŒ€í•´ ìì‹ ê³¼ ì–¼ë§ˆë‚˜ ì¼ì¹˜í•˜ëŠ”ì§€ ì„ íƒí•˜ì„¸ìš”</li>
                    <li>ì •ë‹µì€ ì—†ìœ¼ë‹ˆ ì†”ì§í•˜ê²Œ ë‹µí•´ì£¼ì„¸ìš”</li>
                    <li>í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ ìì‹ ì˜ IBTIë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                </ul>
            </div>

            <button class="btn btn-primary" id="start-btn" disabled>ì‹œì‘í•˜ê¸°</button>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ í™”ë©´ -->
        <div id="test-screen" class="hidden">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="question-counter">ì§ˆë¬¸ 1 / 30</span>
                    <span id="progress-percent">3%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>

            <div class="question-box">
                <h2 class="question-text" id="question-text"></h2>
            </div>

            <div class="answer-options" id="answer-options">
                <button class="answer-btn option-5" data-score="5">ë§¤ìš° ê·¸ë ‡ë‹¤</button>
                <button class="answer-btn option-4" data-score="4">ê·¸ë ‡ë‹¤</button>
                <button class="answer-btn option-3" data-score="3">ë³´í†µì´ë‹¤</button>
                <button class="answer-btn option-2" data-score="2">ê·¸ë ‡ì§€ ì•Šë‹¤</button>
                <button class="answer-btn option-1" data-score="1">ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤</button>
            </div>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div id="result-screen" class="hidden">
            <div class="result-header">
                <h1>ğŸ‰ ì§„ë‹¨ ì™„ë£Œ!</h1>
                <p class="subtitle"><span id="result-name"></span>ë‹˜ì˜ IBTI ê²°ê³¼ì…ë‹ˆë‹¤</p>
            </div>

            <div class="ibti-result-box">
                <h3>ë‚˜ì˜ IBTI ìœ í˜•</h3>
                <div class="ibti-code" id="ibti-code"></div>
                <p>ìƒìœ„ 4ê°€ì§€ í•™ìŠµììƒì˜ ì¡°í•©ì…ë‹ˆë‹¤</p>
            </div>

            <div class="result-card">
                <h2 style="margin-bottom: 20px;">ğŸ’ ë‚˜ì˜ ìƒìœ„ 4ê°€ì§€ í•™ìŠµììƒ</h2>
            </div>

            <div id="top-profiles"></div>

            <div class="all-scores">
                <h2 style="margin-bottom: 20px;">ğŸ“Š ì „ì²´ í•™ìŠµììƒ ì ìˆ˜</h2>
                <div id="all-scores"></div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" id="restart-btn">ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°</button>
                <button class="btn btn-secondary" id="view-history-btn" style="background: #f0f4ff; border-color: #667eea;">ğŸ“‹ ë‹¤ë¥¸ ê²°ê³¼ ë³´ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        // Google Apps Script ë°°í¬ URL (ì—¬ê¸°ì— ë³µì‚¬í•œ URLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”)
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzxzDBrGYJaN5FiBDuDArnr8oy69N1NNl4LA3kwjUXG-LlcFxAAIPW5Ft4ilTopk0Fq/exec'; 

        // IB í•™ìŠµììƒ ì •ì˜
        const learnerProfiles = {
            inquirer: { 
                name: 'íƒêµ¬í•˜ëŠ” ì‚¬ëŒ', 
                nameEn: 'Inquirers', 
                code: 'I', 
                emoji: 'ğŸ”', 
                color: '#E91E63',
                desc: 'í˜¸ê¸°ì‹¬ì„ ê°€ì§€ê³  íƒêµ¬í•˜ë©°, ìŠ¤ìŠ¤ë¡œ ë°°ìš°ëŠ” ì¦ê±°ì›€ì„ ëŠë‚ë‹ˆë‹¤.' 
            },
            knowledgeable: { 
                name: 'ì§€ì‹ì´ í’ë¶€í•œ ì‚¬ëŒ', 
                nameEn: 'Knowledgeable', 
                code: 'K', 
                emoji: 'ğŸ“š', 
                color: '#9C27B0',
                desc: 'ë‹¤ì–‘í•œ ë¶„ì•¼ì˜ ì§€ì‹ì„ íƒêµ¬í•˜ê³ , ì´ë¥¼ í†µí•´ ê°œë…ì  ì´í•´ë¥¼ ë„“í™ë‹ˆë‹¤.' 
            },
            thinker: { 
                name: 'ì‚¬ê³  í•˜ëŠ” ì‚¬ëŒ', 
                nameEn: 'Thinkers', 
                code: 'T', 
                emoji: 'ğŸ’­', 
                color: '#2196F3',
                desc: 'ë³µì¡í•œ ë¬¸ì œë¥¼ ë¹„íŒì ì´ê³  ì°½ì˜ì ìœ¼ë¡œ ìƒê°í•˜ì—¬ í•´ê²°í•©ë‹ˆë‹¤.' 
            },
            communicator: { 
                name: 'ì†Œí†µí•˜ëŠ” ì‚¬ëŒ', 
                nameEn: 'Communicators', 
                code: 'M', 
                emoji: 'ğŸ’¬', 
                color: '#00BCD4',
                desc: 'ë‹¤ì–‘í•œ ì–¸ì–´ì™€ ë°©ì‹ìœ¼ë¡œ ìì‹ ìˆê²Œ ì†Œí†µí•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒì˜ ë§ì„ ê²½ì²­í•©ë‹ˆë‹¤.' 
            },
            principled: { 
                name: 'ì›ì¹™ì„ ì§€í‚¤ëŠ” ì‚¬ëŒ', 
                nameEn: 'Principled', 
                code: 'P', 
                emoji: 'âš–ï¸', 
                color: '#009688',
                desc: 'ì •ì§í•˜ê³  ê³µì •í•˜ë©°, ì±…ì„ê° ìˆê²Œ í–‰ë™í•©ë‹ˆë‹¤.' 
            },
            openMinded: { 
                name: 'ì—´ë¦° ë§ˆìŒì„ ê°€ì§„ ì‚¬ëŒ', 
                nameEn: 'Open-minded', 
                code: 'O', 
                emoji: 'ğŸŒ', 
                color: '#4CAF50',
                desc: 'ìì‹ ì˜ ë¬¸í™”ì™€ ì—­ì‚¬ë¥¼ ì†Œì¤‘íˆ ì—¬ê¸°ë©°, ë‹¤ë¥¸ ì‚¬ëŒì˜ ê´€ì ê³¼ ê°€ì¹˜ë¥¼ ì¡´ì¤‘í•©ë‹ˆë‹¤.' 
            },
            caring: { 
                name: 'ë°°ë ¤í•˜ëŠ” ì‚¬ëŒ', 
                nameEn: 'Caring', 
                code: 'C', 
                emoji: 'â¤ï¸', 
                color: '#8BC34A',
                desc: 'ë‹¤ë¥¸ ì‚¬ëŒì˜ ê°ì •ì„ ì´í•´í•˜ê³  ë°°ë ¤í•˜ë©°, ê¸ì •ì ì¸ ë³€í™”ë¥¼ ìœ„í•´ ë´‰ì‚¬í•©ë‹ˆë‹¤.' 
            },
            riskTaker: { 
                name: 'ë„ì „í•˜ëŠ” ì‚¬ëŒ', 
                nameEn: 'Risk-takers', 
                code: 'R', 
                emoji: 'ğŸš€', 
                color: '#FF9800',
                desc: 'ë¶ˆí™•ì‹¤í•œ ìƒí™©ì— ìš©ê¸° ìˆê²Œ ë„ì „í•˜ë©°, ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ íƒêµ¬í•©ë‹ˆë‹¤.' 
            },
            balanced: { 
                name: 'ê· í˜• ì¡íŒ ì‚¬ëŒ', 
                nameEn: 'Balanced', 
                code: 'B', 
                emoji: 'âš–ï¸', 
                color: '#FF5722',
                desc: 'ì§€ì , ì‹ ì²´ì , ì •ì„œì  ê· í˜•ì„ ì¤‘ìš”í•˜ê²Œ ì—¬ê¸°ë©°, ìì‹ ê³¼ íƒ€ì¸ì˜ ì•ˆë…•ì„ ë„ëª¨í•©ë‹ˆë‹¤.' 
            },
            reflective: { 
                name: 'ì„±ì°°í•˜ëŠ” ì‚¬ëŒ', 
                nameEn: 'Reflective', 
                code: 'F', 
                emoji: 'ğŸ¤”', 
                color: '#2979FF',
                desc: 'ìì‹ ì˜ í•™ìŠµê³¼ ê²½í—˜ì„ ë˜ëŒì•„ë³´ë©°, ê°•ì ê³¼ ì•½ì ì„ íŒŒì•…í•˜ì—¬ ì„±ì¥í•©ë‹ˆë‹¤.' 
            }
        };

        // ì§ˆë¬¸ ë°ì´í„° (ê¸°ë³¸ê°’)
        const defaultQuestions = [
            // Inquirers
            { id: 1, text: 'ìƒˆë¡œìš´ ê²ƒì„ ë³´ë©´ â€œì™œ ê·¸ëŸ´ê¹Œ?â€ í•˜ëŠ” ë§ˆìŒì´ ë“ ë‹¤.', profile: 'inquirer' },
            { id: 2, text: 'ëª¨ë¥´ëŠ” ê²ƒì´ ìƒê¸°ë©´ ë°”ë¡œ ì•Œì•„ë³´ë ¤ê³  í•œë‹¤.', profile: 'inquirer' },
            { id: 3, text: 'ê³¼ì œë¥¼ í•  ë•Œ ë¨¼ì € ìŠ¤ìŠ¤ë¡œ ì°¾ì•„ë³¸ë‹¤.', profile: 'inquirer' },
            { id: 4, text: 'ì¹œêµ¬ë“¤ ì•ì—ì„œë„ ì§ˆë¬¸ì„ ì˜í•œë‹¤.', profile: 'inquirer' },
            { id: 5, text: 'ê¶ê¸ˆí•œ ê²Œ ìˆìœ¼ë©´ ì˜¤ë˜ ì°¾ì•„ë³´ëŠ” í¸ì´ë‹¤.', profile: 'inquirer' },
            { id: 6, text: 'ë¬¸ì œë¥¼ í’€ ë•Œ ì—¬ëŸ¬ ì±…ì´ë‚˜ ìë£Œë¥¼ ë¹„êµí•´ë³¸ë‹¤.', profile: 'inquirer' },
            { id: 7, text: 'í•œ ê°€ì§€ ìƒê°ë³´ë‹¤ ì—¬ëŸ¬ ìƒê°ì„ ë– ì˜¬ë¦¬ë ¤ í•œë‹¤.', profile: 'inquirer' },
            { id: 8, text: 'ê³µë¶€í•  ë•Œ â€œì™œ ê·¸ëŸ°ì§€ ì´ìœ â€ë¥¼ ì•Œê³  ì‹¶ë‹¤.', profile: 'inquirer' },
            { id: 9, text: 'ì²˜ìŒ ì•Œê²Œëœ ì£¼ì œì— ëŒ€í•´ì„œë„ ê³µë¶€í•˜ê³  ì•Œì•„ë³´ê³  ì‹¶ë‹¤.', profile: 'inquirer' },
            { id: 10, text: 'ìˆ˜ì—…ì´ë‚˜ ëª¨ë‘ ì—ì„œ ì§ˆë¬¸ì„ ìì£¼ í•œë‹¤.', profile: 'inquirer' },
            // Knowledgeable
            { id: 11, text: 'ë°°ìš´ ê²ƒì„ ì„œë¡œ ì´ì–´ì„œ ìƒê°í•˜ë ¤ í•œë‹¤.', profile: 'knowledgeable' },
            { id: 12, text: 'ê²‰ëª¨ì–‘(ê²‰ë³´ê¸°)ë§Œ ì•„ëŠ” ê²ƒë³´ë‹¤ ê¹Šê²Œ ì•„ëŠ” ê²ƒì´ ë” ì¢‹ë‹¤.', profile: 'knowledgeable' },
            { id: 13, text: 'ì¢‹ì•„í•˜ëŠ” ê³µë¶€ë¥¼ ì˜¤ë˜ í•´ë³¸ ì ì´ ìˆë‹¤.', profile: 'knowledgeable' },
            { id: 14, text: 'ë°°ìš´ ê²ƒì„ ì‹¤ì œ ë¬¸ì œì— ì¨ë³´ë ¤ê³  í•œë‹¤.', profile: 'knowledgeable' },
            { id: 15, text: 'ìƒˆë¡œìš´ ì •ë³´ë¥¼ ë“¤ìœ¼ë©´ ì´ë¯¸ ì•„ëŠ” ê²ƒê³¼ ì—°ê²°í•´ë³¸ë‹¤.', profile: 'knowledgeable' },
            { id: 16, text: 'ë‚´ê°€ ì•„ëŠ” ê²ƒì„ ì¹œêµ¬ì—ê²Œ ì„¤ëª…í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.', profile: 'knowledgeable' },
            { id: 17, text: 'ìˆ˜ì—…ì´ ëë‚˜ë„ í˜¼ì ë” ì°¾ì•„ë³´ëŠ” í¸ì´ë‹¤.', profile: 'knowledgeable' },
            { id: 18, text: 'ë‹¤ë¥¸ ì˜ˆë¥¼ ë³´ë©° ë¹„ìŠ·í•œ ì ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.', profile: 'knowledgeable' },
            { id: 19, text: 'ë‚´ê°€ ì¢‹ì•„í•˜ëŠ” ì£¼ì œì˜ ìƒˆ ì†Œì‹ì„ ê´€ì‹¬ ìˆê²Œ ë³¸ë‹¤.', profile: 'knowledgeable' },
            { id: 20, text: 'ë¬¸ì œë¥¼ í’€ ë•Œ ì•Œê³  ìˆëŠ” ì§€ì‹ì„ ì‚¬ìš©í•œë‹¤.', profile: 'knowledgeable' },
            // Thinkers
            { id: 21, text: 'ì–´ë–¤ ì¼ì´ ìƒê¸°ë©´ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚œ ê²ƒì¸ì§€ ê³°ê³°ì´ ìƒê°í•´ë³¸ë‹¤.', profile: 'thinker' },
            { id: 22, text: 'ì–´ë ¤ìš´ ë¬¸ì œë„ ì°¨ê·¼ì°¨ê·¼ ì‚´í´ë³¸ë‹¤.', profile: 'thinker' },
            { id: 23, text: 'ê²°ì •ì„ í•  ë•Œ ì—¬ëŸ¬ ë°©ë²•ì„ ë¹„êµí•´ë³¸ë‹¤.', profile: 'thinker' },
            { id: 24, text: 'â€œì™œ ì´ë ‡ê²Œ ëì„ê¹Œ?â€ í•˜ê³  ìì£¼ ìƒê°í•œë‹¤.', profile: 'thinker' },
            { id: 25, text: 'ì •ë³´(ì•Œê³  ìˆëŠ” ê²ƒ)ê°€ ë¶€ì¡±í•˜ë©´ ë” ì°¾ì•„ë³¸ë‹¤.', profile: 'thinker' },
            { id: 26, text: 'ë‹¤ì–‘í•œ ê°ì •ì´ ë“œëŠ” ìƒí™©ì—ì„œë„ ì°¨ë¶„íˆ ìƒê°í•˜ë ¤ í•œë‹¤.', profile: 'thinker' },
            { id: 27, text: 'ê³¼ì œë¥¼ í•  ë•Œ ë¨¼ì € ê³„íšì„ ì„¸ìš´ë‹¤.', profile: 'thinker' },
            { id: 28, text: 'ì¹œêµ¬ë“¤ì´ ëª» ë³¸ ì‹¤ìˆ˜ë‚˜ ì˜ëª»ì„ ì˜ ì•Œì•„ì±„ëŠ” í¸ì´ë‹¤.', profile: 'thinker' },
            { id: 29, text: 'ë‹µë³´ë‹¤ ì–´ë–»ê²Œ í’€ì—ˆëŠ”ì§€ ê³¼ì •ì„ ë” ì¤‘ìš”í•˜ê²Œ ìƒê°í•œë‹¤.', profile: 'thinker' },
            { id: 30, text: 'ì–´ë ¤ìš´ ë‚´ìš©ì„ ì‰¬ìš´ ë§ë¡œ ë°”ê¾¸ì–´ ë§í•˜ëŠ” ê±¸ ì¢‹ì•„í•œë‹¤.', profile: 'thinker' },
            // Communicators
            { id: 31, text: 'ë‚´ ë§ì„ ì¹œêµ¬ê°€ ì˜ ì´í•´í•˜ë„ë¡ ë§í•˜ë ¤ í•œë‹¤.', profile: 'communicator' },
            { id: 32, text: 'ë§ì´ ë§í•˜ê¸°ë³´ë‹¤ ì˜ ë“£ëŠ” ê²ƒë„ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•œë‹¤.', profile: 'communicator' },
            { id: 33, text: 'ë°œí‘œí•  ë•Œ ë§ì´ ë–¨ì§€ ì•ŠëŠ”ë‹¤.', profile: 'communicator' },
            { id: 34, text: 'ì¹œêµ¬ ë§ì˜ ì§„ì§œ ëœ»ì„ ìƒê°í•´ë³´ë ¤ê³  í•œë‹¤.', profile: 'communicator' },
            { id: 35, text: 'ì˜ê²¬ì´ ë‹¤ë¥¼ ë•Œë„ ì¡°ìš©íˆ ëŒ€í™”ë¥¼ ì´ì–´ê°€ë ¤ í•œë‹¤.', profile: 'communicator' },
            { id: 36, text: 'ë§Â·ê·¸ë¦¼Â·ê¸€ ë“± ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤.', profile: 'communicator' },
            { id: 37, text: 'ëª¨ë‘ ì—ì„œ ì„œë¡œ ë‹¤íˆ´ ë•Œ ì‚¬ì´ì¢‹ê²Œ ë§Œë“¤ë ¤ê³  í•œë‹¤.', profile: 'communicator' },
            { id: 38, text: 'ì§ˆë¬¸ì„ í•  ë•Œ ì‰½ê³  ë¶„ëª…í•˜ê²Œ í•˜ë ¤ê³  í•œë‹¤.', profile: 'communicator' },
            { id: 39, text: 'í† ë¡ í•  ë•Œ ì´ê¸°ë ¤ê³  í•˜ê¸°ë³´ë‹¤ ìƒëŒ€ë°©ì— ëŒ€í•´ ì´í•´í•˜ë ¤ê³  ë…¸ë ¥í•œë‹¤.', profile: 'communicator' },
            { id: 40, text: 'ë°œí‘œ ì¤€ë¹„ë¥¼ í•  ë•Œ ë‚´ìš©ì„ ì˜ ì •ë¦¬í•œë‹¤.', profile: 'communicator' },
            // Principled
            { id: 41, text: 'ì•„ë¬´ë„ ë³´ì§€ ì•Šì•„ë„ ê·œì¹™ì„ ì§€í‚¤ë ¤ê³  í•œë‹¤.', profile: 'principled' },
            { id: 42, text: 'ì •ì§í•˜ê²Œ ë§í•˜ê³  í–‰ë™í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤. (ì •ì§: ê±°ì§“ë§í•˜ì§€ ì•Šê¸°)', profile: 'principled' },
            { id: 43, text: 'ì•½ì†ì„ ê¼­ ì§€í‚¤ë ¤ê³  ë…¸ë ¥í•œë‹¤.', profile: 'principled' },
            { id: 44, text: 'ë§¡ì€ ì¼ì„ ëê¹Œì§€ í•œë‹¤.', profile: 'principled' },
            { id: 45, text: 'ë¶ˆê³µí‰(ê³µì •í•˜ì§€ ì•Šì€)í•œ ì¼ì„ ë³´ë©´ ê·¸ëƒ¥ ì§€ë‚˜ì¹˜ê¸° ì–´ë µë‹¤.', profile: 'principled' },
            { id: 46, text: 'ê³¼ì œë¥¼ í•  ë•Œ ê±°ì§“ë§ë¡œ ê¾¸ë©°ë‚´ê±°ë‚˜ ë‚¨ì„ ì†ì´ì§€ ì•ŠëŠ”ë‹¤.', profile: 'principled' },
            { id: 47, text: 'ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ í”¼í•´(ë‚˜ìœ ì˜í–¥)ë¥¼ ì£¼ì§€ ì•Šìœ¼ë ¤ í•œë‹¤.', profile: 'principled' },
            { id: 48, text: 'ì˜ëª»í•˜ë©´ ìˆ¨ê¸°ì§€ ì•Šê³  ì¸ì •í•œë‹¤.', profile: 'principled' },
            { id: 49, text: 'ëª¨ë‘ê°€ í•¨ê»˜ ì§€í‚¤ëŠ” ê·œì¹™ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•œë‹¤.', profile: 'principled' },
            { id: 50, text: 'ëª¨ë“  ì‚¬ëŒì´ ê°™ì€ ê¸°ì¤€(ê·œì¹™)ìœ¼ë¡œ í‰ê°€ë°›ì•„ì•¼ í•œë‹¤ê³  ìƒê°í•œë‹¤.', profile: 'principled' },
            // Open-minded
            { id: 51, text: 'ë‚˜ì™€ ë‹¤ë¥¸ ì˜ê²¬ì´ ìˆì–´ë„ ì´ìœ ë¥¼ ë¨¼ì € ë“¤ì–´ë³´ë ¤ê³  í•œë‹¤.', profile: 'openMinded' },
            { id: 52, text: 'ë‹¤ë¥¸ ë‚˜ë¼ë‚˜ ë¬¸í™”ê°€ ê¶ê¸ˆí•˜ë‹¤. (ë¬¸í™”: ì‚¬ëŒì´ ì‚¬ëŠ” ë°©ë²•ì´ë‚˜ ëª¨ìŠµ)', profile: 'openMinded' },
            { id: 53, text: 'ë‚´ê°€ í‹€ë¦´ ìˆ˜ë„ ìˆë‹¤ê³  ìƒê°í•˜ëŠ” ê²Œ ì–´ë µì§€ ì•Šë‹¤.', profile: 'openMinded' },
            { id: 54, text: 'ìƒˆ ë°©ë²•ì´ ë‚˜ì˜¤ë©´ í•œ ë²ˆ í•´ë³´ë ¤ í•œë‹¤.', profile: 'openMinded' },
            { id: 55, text: 'ì‚¬ëŒì„ ë§Œë‚  ë•Œ í¸ê²¬(ë¯¸ë¦¬ ì •í•œ ìƒê°) ì—†ì´ ëŒ€í•˜ë ¤ í•œë‹¤.', profile: 'openMinded' },
            { id: 56, text: 'ì˜ê²¬ì´ ë¶€ë”ªí˜€ë„ ìƒëŒ€ì˜ ì…ì¥ì„ ìƒê°í•œë‹¤.', profile: 'openMinded' },
            { id: 57, text: 'ìµìˆ™í•˜ì§€ ì•Šì€ ë‚´ìš©ì„ ì•Œê²Œë˜ë„ ì°¨ë¶„í•˜ê²Œ ì‚´í´ë³´ê³  ìƒê°í•œë‹¤.', profile: 'openMinded' },
            { id: 58, text: 'ë‚˜ì™€ ë‹¤ë¥¸ í–‰ë™ ë°©ì‹ì´ ì´ìƒí•´ ë³´ì—¬ë„ ë¨¼ì € ì´í•´í•˜ë ¤ í•œë‹¤.', profile: 'openMinded' },
            { id: 59, text: 'ìƒˆë¡œìš´ ì–¸ì–´(ë§)ë‚˜ ë¬¸í™”ë¥¼ ë°°ìš°ëŠ” ê²Œ ì¬ë¯¸ìˆë‹¤.', profile: 'openMinded' },
            { id: 60, text: 'í† ë¡ ì—ì„œ ë‚´ê°€ í‹€ë ¸ë‹¤ëŠ” ê±¸ ì¸ì •í•˜ëŠ” ê²ƒì´ ê´œì°®ë‹¤.', profile: 'openMinded' },
            // Caring
            { id: 61, text: 'ì¹œêµ¬ê°€ í˜ë“¤ë©´ ë„ì™€ì£¼ê³  ì‹¶ë‹¤.', profile: 'caring' },
            { id: 62, text: 'ë‹¤íˆ¬ëŠ” ìƒí™©ì—ì„œë„ ìƒëŒ€ë¥¼ ì¡´ì¤‘(ì˜ˆì˜ ìˆê²Œ ëŒ€í•¨)í•˜ë ¤ í•œë‹¤.', profile: 'caring' },
            { id: 63, text: 'ëˆ„êµ°ê°€ ê¸°ë¶„ì´ ì´ìƒí•´ ë³´ì´ë©´ ê¸ˆë°© ëˆˆì¹˜ì±ˆë‹¤.', profile: 'caring' },
            { id: 64, text: 'í•¨ê»˜í•˜ëŠ” ì¼ì„ ìœ„í•´ ë‚´ ì‹œê°„ì„ ì“°ëŠ” ê²ƒì´ ê´œì°®ë‹¤.', profile: 'caring' },
            { id: 65, text: 'ëˆ„ê°€ ë„ì›€ì„ êµ¬í•˜ë©´ ë°”ë¹ ë„ ë„ìš°ë ¤ê³  í•œë‹¤.', profile: 'caring' },
            { id: 66, text: 'ìƒëŒ€ë°©ì˜ ë§ˆìŒì„ ìƒê°í•´ë³´ë ¤ í•œë‹¤.', profile: 'caring' },
            { id: 67, text: 'ì¹œêµ¬ê°€ í˜¼ì ìˆìœ¼ë©´ ì‹ ê²½ ì“°ì¸ë‹¤.', profile: 'caring' },
            { id: 68, text: 'ëª¨ë‘ ì—ì„œ ë¶„ìœ„ê¸°ë¥¼ ì¢‹ê²Œ ë§Œë“¤ë ¤ê³  í•œë‹¤.', profile: 'caring' },
            { id: 69, text: 'ê³ ë§ˆì›€ì„ ìì£¼ í‘œí˜„í•œë‹¤.', profile: 'caring' },
            { id: 70, text: 'ì§€ê¸ˆ ë‹¹ì¥ ë‚˜ì—ê²Œ ì´ìµì´ ì—†ì–´ë„ ë„ìš¸ ìˆ˜ ìˆë‹¤.', profile: 'caring' },
            // Risk-takers
            { id: 71, text: 'ì²˜ìŒ í•˜ëŠ” ì¼ì´ì–´ë„ í•´ë³´ê³  ì‹¶ì€ ë§ˆìŒì´ ë“ ë‹¤.', profile: 'riskTaker' },
            { id: 72, text: 'ì‹¤íŒ¨(ì˜ ì•ˆ ë˜ëŠ” ê²ƒ)í•˜ë”ë¼ë„ ë‹¤ì‹œ í•´ë³´ë ¤ í•œë‹¤.', profile: 'riskTaker' },
            { id: 73, text: 'ë‚¯ì„  ê³³ì´ë‚˜ ì²˜ìŒ ë³´ëŠ” ìƒí™©ì—ì„œë„ ì ì‘í•˜ë ¤ í•œë‹¤.', profile: 'riskTaker' },
            { id: 74, text: 'ë°œí‘œë‚˜ ê²½ìŸ ìƒí™©ì—ë„ ì°¸ì—¬í•˜ë ¤ í•œë‹¤.', profile: 'riskTaker' },
            { id: 75, text: 'ìƒˆë¡œìš´ í™œë™ì„ í•˜ë©´ ì„¤ë Œë‹¤. (ì„¤ë Œë‹¤: ê¸°ë¶„ì´ ë‘ê·¼ë‘ê·¼í•˜ë‹¤)', profile: 'riskTaker' },
            { id: 76, text: 'ë¬¸ì œë¥¼ ë§ˆì£¼í•˜ë©´ í”¼í•˜ì§€ ì•Šê³  í•´ê²°í•˜ë ¤ í•œë‹¤.', profile: 'riskTaker' },
            { id: 77, text: 'ë†’ì€ ëª©í‘œ(í° ê¿ˆ)ë¥¼ ì„¸ìš°ëŠ” ê²Œ ì–´ë µì§€ ì•Šë‹¤.', profile: 'riskTaker' },
            { id: 78, text: 'ì˜ ëª¨ë¥´ëŠ” ìƒí™©ì—ì„œë„ ê²°ì •ì„ í•  ìˆ˜ ìˆë‹¤.', profile: 'riskTaker' },
            { id: 79, text: 'ìƒˆë¡œìš´ ë°©ë²•ì„ ì‹œí—˜í•´ë³´ëŠ” í¸ì´ë‹¤.', profile: 'riskTaker' },
            { id: 80, text: 'ë¹„íŒ(ì•ˆ ì¢‹ì€ ë§)ì„ ë“¤ì„ ìˆ˜ë„ ìˆì–´ë„ ë‚´ ì˜ê²¬ì„ ë§í•œë‹¤.', profile: 'riskTaker' },
            // Balanced
            { id: 81, text: 'ê³µë¶€Â·ì‰¬ê¸°Â·ë†€ê¸° ì‹œê°„ì„ ê³¨ê³ ë£¨ í•˜ë ¤ê³  í•œë‹¤.', profile: 'balanced' },
            { id: 82, text: 'ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ìœ¼ë©´ ìŠ¤ìŠ¤ë¡œ ì¡°ì ˆí•˜ë ¤ í•œë‹¤.', profile: 'balanced' },
            { id: 83, text: 'ëª¸ ì“°ëŠ” ì¼ê³¼ ìƒê°í•˜ëŠ” ì¼ì„ ê· í˜• ìˆê²Œ í•˜ë ¤ê³  í•œë‹¤.', profile: 'balanced' },
            { id: 84, text: 'ì¹œêµ¬Â·ê°€ì¡±Â·í•™êµ ìƒí™œì„ ê³ ë¥´ê²Œ ì±™ê¸°ë ¤ê³  í•œë‹¤.', profile: 'balanced' },
            { id: 85, text: 'ì‹œê°„ì´ ë¶€ì¡±í•˜ë©´ ìš°ì„ ìˆœìœ„(ë¨¼ì € í•  ê²ƒ)ë¥¼ ì •í•œë‹¤.', profile: 'balanced' },
            { id: 86, text: 'í•œ ê°€ì§€ì— ë„ˆë¬´ ëª°ë‘(ë„ˆë¬´ ë¹ ì ¸ë²„ë¦¼)í•˜ì§€ ì•Šìœ¼ë ¤ê³  í•œë‹¤.', profile: 'balanced' },
            { id: 87, text: 'ìš´ë™ì´ë‚˜ ì‰¬ëŠ” ì‹œê°„ì„ ì±™ê¸°ë ¤ê³  í•œë‹¤.', profile: 'balanced' },
            { id: 88, text: 'í•™ìƒÂ·ì¹œêµ¬Â·ê°€ì¡± ì—­í• ì„ ê· í˜• ìˆê²Œ í•˜ë ¤ê³  í•œë‹¤.', profile: 'balanced' },
            { id: 89, text: 'ë§ˆìŒì´ í˜ë“¤ë©´ ë„ì›€ì„ ìš”ì²­í•  ìˆ˜ ìˆë‹¤.', profile: 'balanced' },
            { id: 90, text: 'ê·œì¹™ì ì¸ ìƒí™œ(ë§¤ì¼ ë¹„ìŠ·í•˜ê²Œ í•˜ëŠ” ìƒí™œ)ì´ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•œë‹¤.', profile: 'balanced' },
            // Reflective
            { id: 91, text: 'í•˜ë£¨ê°€ ëë‚˜ë©´ ì˜¤ëŠ˜ í•œ ì¼ì„ ë– ì˜¬ë ¤ë³¸ë‹¤.', profile: 'reflective' },
            { id: 92, text: 'ì˜í•œ ì Â·ê³ ì¹  ì ì„ ìŠ¤ìŠ¤ë¡œ ìƒê°í•´ë³¸ë‹¤.', profile: 'reflective' },
            { id: 93, text: 'ì‹¤ìˆ˜í•˜ë©´ â€œì™œ ê·¸ë¬ì„ê¹Œ?â€ í•˜ê³  ìƒê°í•œë‹¤.', profile: 'reflective' },
            { id: 94, text: 'ê³µë¶€ë‚˜ í™œë™ì´ ëë‚œ ë’¤ ë‹¤ì‹œ ë˜ëŒì•„ë³¸ë‹¤.', profile: 'reflective' },
            { id: 95, text: 'ì–´ë–¤ ê³µë¶€ ë°©ë²•ì´ ë‚˜ì—ê²Œ ë§ëŠ”ì§€ ê³ ë¯¼í•œë‹¤.', profile: 'reflective' },
            { id: 96, text: 'ëª©í‘œ(í•˜ê³  ì‹¶ì€ ê²ƒ)ë¥¼ ì„¸ìš°ê³  ì˜ ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.', profile: 'reflective' },
            { id: 97, text: 'ë‚´ ê°ì •ì´ ì™œ ìƒê²¼ëŠ”ì§€ ìƒê°í•´ë³¸ë‹¤.', profile: 'reflective' },
            { id: 98, text: 'ì¹œêµ¬ì™€ ë‹¤íˆ¬ë©´ ë‚´ í–‰ë™ì„ ë¨¼ì € ëŒì•„ë³¸ë‹¤.', profile: 'reflective' },
            { id: 99, text: 'ê²°ê³¼ë³´ë‹¤ ë°°ìš°ëŠ” ê³¼ì •ì´ ë” ì¤‘ìš”í•˜ë‹¤ê³  ëŠë‚€ë‹¤.', profile: 'reflective' },
            { id: 100, text: 'ë‚´ í–‰ë™ ìŠµê´€(ìì£¼ í•˜ëŠ” í–‰ë™)ì„ ì•Œì•„ë³´ë ¤ê³  í•œë‹¤.', profile: 'reflective' }
        ];

        // ì €ì¥ëœ ë¬¸í•­ì´ ìˆìœ¼ë©´ ë¶ˆëŸ¬ì˜¤ê³ , ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
        let questions = JSON.parse(JSON.stringify(defaultQuestions)); // ê¹Šì€ ë³µì‚¬ë¡œ ì´ˆê¸°í™”

        // êµ¬ê¸€ ì‹œíŠ¸ ë˜ëŠ” ë¡œì»¬ì—ì„œ ë¬¸í•­ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadQuestions() {
            try {
                // 1. êµ¬ê¸€ ì‹œíŠ¸ ì‹œë„
                if (GOOGLE_SCRIPT_URL) {
                    console.log('êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ ë¬¸í•­ ë¡œë“œ ì‹œë„...');
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 5000); // 5ì´ˆ íƒ€ì„ì•„ì›ƒ

                    try {
                        const response = await fetch(GOOGLE_SCRIPT_URL + '?type=questions', {
                            signal: controller.signal
                        });
                        clearTimeout(timeoutId);
                        
                        const data = await response.json();
                        if (data && data.length > 0) {
                            questions = data;
                            console.log('Google Sheetì—ì„œ ìµœì‹  ë¬¸í•­ ë¡œë“œ ì„±ê³µ (' + questions.length + 'ê°œ)');
                            return; // ì„±ê³µí•˜ë©´ ì—¬ê¸°ì„œ ì¢…ë£Œ
                        } else {
                            console.warn('Google Sheet ë¬¸í•­ ë°ì´í„°ê°€ ë¹„ì–´ìˆìŒ');
                        }
                    } catch (fetchError) {
                        console.warn('Google Sheet ë¡œë“œ ì‹¤íŒ¨ (ë¡œì»¬/ê¸°ë³¸ê°’ ì‚¬ìš©):', fetchError);
                    }
                }
            } catch (e) {
                console.error('ë¬¸í•­ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
            }

            // 2. ì‹¤íŒ¨ ì‹œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í™•ì¸ (ë°±ì—…ìš©)
            const stored = JSON.parse(localStorage.getItem('ibTestQuestions'));
            if (stored && stored.length > 0) {
                questions = stored;
                console.log('ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë¬¸í•­ ë¡œë“œ (' + questions.length + 'ê°œ)');
            } else {
                console.log('ê¸°ë³¸ ë¬¸í•­ ì‚¬ìš©');
            }
        }

        // ì´ˆê¸°í™” ì‹œ ì‹¤í–‰ (ë¹„ë™ê¸°)
        // ì£¼ì˜: startBtn í´ë¦­ ì‹œì ì—ëŠ” ë¡œë“œê°€ ì™„ë£Œë˜ì–´ ìˆì–´ì•¼ í•¨
        loadQuestions();

        // ìƒíƒœ ê´€ë¦¬
        let currentQuestion = 0;
        let answers = {};
        let activeQuestions = []; // í™œì„±í™”ëœ ì§ˆë¬¸ ëª©ë¡
        let studentName = '';
        let studentGrade = '';
        let studentClass = '';
        let studentNumber = '';

        // DOM ìš”ì†Œ
        const introScreen = document.getElementById('intro-screen');
        const testScreen = document.getElementById('test-screen');
        const resultScreen = document.getElementById('result-screen');
        const startBtn = document.getElementById('start-btn');
        const studentNameInput = document.getElementById('student-name');
        const studentGradeInput = document.getElementById('student-grade');
        const studentClassInput = document.getElementById('student-class');
        const studentNumberInput = document.getElementById('student-number');
        const questionText = document.getElementById('question-text');
        const questionCounter = document.getElementById('question-counter');
        const progressPercent = document.getElementById('progress-percent');
        const progressFill = document.getElementById('progress-fill');
        const answerOptions = document.getElementById('answer-options');
        const restartBtn = document.getElementById('restart-btn');

        // ì…ë ¥ í™•ì¸
        function checkInputs() {
            const nameValue = studentNameInput.value.trim();
            const gradeValue = studentGradeInput.value.trim();
            const classValue = studentClassInput.value.trim();
            const numberValue = studentNumberInput.value.trim();
            startBtn.disabled = !(nameValue && gradeValue && classValue && numberValue);
        }

        studentNameInput.addEventListener('input', checkInputs);
        studentGradeInput.addEventListener('input', checkInputs);
        studentClassInput.addEventListener('input', checkInputs);
        studentNumberInput.addEventListener('input', checkInputs);

        // ì‹œì‘ ë²„íŠ¼
        startBtn.addEventListener('click', () => {
            studentName = studentNameInput.value.trim();
            studentGrade = studentGradeInput.value.trim();
            studentClass = studentClassInput.value.trim();
            studentNumber = studentNumberInput.value.trim();

            // ë¬¸í•­ ìˆ˜ ì„ íƒ ì²˜ë¦¬
            const testType = document.querySelector('input[name="test-type"]:checked').value;
            activeQuestions = [];
            
            if (testType === '50') {
                // 50ë¬¸í•­ ëª¨ë“œ: ê° í”„ë¡œí•„ë³„ë¡œ 'useForShortTest'ê°€ trueì¸ ë¬¸í•­ë§Œ í•„í„°ë§
                // (ê¸°ì¡´ ë°ì´í„° í˜¸í™˜ì„±ì„ ìœ„í•´ ì†ì„±ì´ ì—†ìœ¼ë©´ ì•ì˜ 5ê°œ ì‚¬ìš©)
                
                const profiles = Object.keys(learnerProfiles);
                profiles.forEach(profile => {
                    const profileQuestions = questions.filter(q => q.profile === profile);
                    
                    // useForShortTest ì†ì„±ì´ ìˆëŠ” ë¬¸í•­ ì°¾ê¸°
                    let shortTestQuestions = profileQuestions.filter(q => q.useForShortTest);
                    
                    // ë§Œì•½ ì„¤ì •ëœ ë¬¸í•­ì´ ì—†ë‹¤ë©´(ê¸°ì¡´ ë°ì´í„° ë“±), ì•ì—ì„œë¶€í„° 5ê°œ ìë™ ì„ íƒ
                    if (shortTestQuestions.length === 0) {
                        shortTestQuestions = profileQuestions.slice(0, 5);
                    }
                    
                    // ë§Œì•½ ì„¤ì •ëœ ë¬¸í•­ì´ 5ê°œë³´ë‹¤ ë§ë‹¤ë©´, ì•ì˜ 5ê°œë§Œ ì‚¬ìš© (50ë¬¸í•­ ìœ ì§€ë¥¼ ìœ„í•´)
                    if (shortTestQuestions.length > 5) {
                        shortTestQuestions = shortTestQuestions.slice(0, 5);
                    }

                    activeQuestions.push(...shortTestQuestions);
                });
                
                // ID ìˆœì„œëŒ€ë¡œ ì •ë ¬
                activeQuestions.sort((a, b) => a.id - b.id);
            } else {
                activeQuestions = [...questions];
            }

            introScreen.classList.add('hidden');
            testScreen.classList.remove('hidden');
            showQuestion();
        });

        // ì§ˆë¬¸ í‘œì‹œ
        function showQuestion() {
            const question = activeQuestions[currentQuestion];
            questionText.textContent = question.text;
            questionCounter.textContent = `ì§ˆë¬¸ ${currentQuestion + 1} / ${activeQuestions.length}`;
            const progress = ((currentQuestion + 1) / activeQuestions.length) * 100;
            progressPercent.textContent = `${Math.round(progress)}%`;
            progressFill.style.width = `${progress}%`;
        }

        // ë‹µë³€ ì„ íƒ
        answerOptions.addEventListener('click', (e) => {
            if (e.target.classList.contains('answer-btn')) {
                const score = parseInt(e.target.dataset.score);
                answers[activeQuestions[currentQuestion].id] = score;

                if (currentQuestion < activeQuestions.length - 1) {
                    currentQuestion++;
                    showQuestion();
                } else {
                    calculateResults();
                }
            }
        });

        // ê²°ê³¼ ê³„ì‚°
        function calculateResults() {
            const scores = {};
            Object.keys(learnerProfiles).forEach(profile => {
                scores[profile] = 0;
            });

            // activeQuestions ê¸°ì¤€ìœ¼ë¡œ ì ìˆ˜ ê³„ì‚°
            activeQuestions.forEach(q => {
                const score = answers[q.id] || 0;
                scores[q.profile] += score;
            });

            // ì •ê·œí™” (0-100%)
            // ë¬¸í•­ ìˆ˜ì— ë”°ë¥¸ ìµœëŒ€ ì ìˆ˜ ê³„ì‚° (ë¬¸í•­ ìˆ˜ / 10ê°œ í”„ë¡œí•„ * 5ì )
            const questionsPerProfile = activeQuestions.length / 10;
            const maxScore = questionsPerProfile * 5;
            
            const normalizedScores = {};
            Object.keys(scores).forEach(profile => {
                normalizedScores[profile] = Math.round((scores[profile] / maxScore) * 100);
            });

            // ìƒìœ„ 4ê°œ
            const sortedProfiles = Object.entries(normalizedScores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 4);

            // ì „ì—­ ë³€ìˆ˜ ì—…ë°ì´íŠ¸ (ë‹¤ë¥¸ ê²°ê³¼ ë³´ê¸° ê¸°ëŠ¥ì„ ìœ„í•´ í•„ìˆ˜)
            studentName = studentNameInput.value.trim();
            studentGrade = studentGradeInput.value.trim();
            studentClass = studentClassInput.value.trim();
            studentNumber = studentNumberInput.value.trim();

            // ì €ì¥
            const result = {
                name: studentName,
                grade: studentGrade,
                class: studentClass,
                number: studentNumber,
                date: new Date().toISOString(),
                testType: activeQuestions.length, // ê²€ì‚¬ ìœ í˜• ì €ì¥ (50 or 100)
                scores: normalizedScores,
                topProfiles: sortedProfiles
            };

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ë°±ì—…ìš©)
            const existing = JSON.parse(localStorage.getItem('ibTestResults') || '[]');
            existing.push(result);
            localStorage.setItem('ibTestResults', JSON.stringify(existing));

            // êµ¬ê¸€ ì‹œíŠ¸ë¡œ ì „ì†¡
            if (GOOGLE_SCRIPT_URL) {
                sendToGoogleSheet(result);
            }

            showResults(normalizedScores, sortedProfiles);
        }

        // êµ¬ê¸€ ì‹œíŠ¸ë¡œ ë°ì´í„° ì „ì†¡
        function sendToGoogleSheet(data) {
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // CORS ë¬¸ì œ íšŒí”¼ë¥¼ ìœ„í•´ no-cors ì‚¬ìš© (ì‘ë‹µ í™•ì¸ ë¶ˆê°€)
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(() => {
                console.log('Google Sheet ì „ì†¡ ì™„ë£Œ');
            })
            .catch(error => {
                console.error('Google Sheet ì „ì†¡ ì‹¤íŒ¨:', error);
                alert('ê²°ê³¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ë¡œì»¬ì—ëŠ” ì €ì¥ë¨)');
            });
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResults(scores, topProfiles) {
            testScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            introScreen.classList.add('hidden'); // ì¸íŠ¸ë¡œ í™•ì‹¤íˆ ìˆ¨ê¹€

            document.getElementById('result-name').textContent = studentName;
            
            // í˜„ì¬ í•™ìƒ ì •ë³´ ì—…ë°ì´íŠ¸ (ë‹¤ë¥¸ ê²°ê³¼ ë³´ê¸° ê¸°ëŠ¥ì„ ìœ„í•´)
            // ê²€ì‚¬ë¥¼ ìƒˆë¡œ í–ˆì„ ë•Œë„ ì´ ë³€ìˆ˜ë“¤ì´ ì˜ ìœ ì§€ë˜ì–´ì•¼ í•¨
            if (!studentGrade && document.getElementById('student-grade').value) 
                studentGrade = document.getElementById('student-grade').value;
            if (!studentClass && document.getElementById('student-class').value) 
                studentClass = document.getElementById('student-class').value;
            if (!studentNumber && document.getElementById('student-number').value) 
                studentNumber = document.getElementById('student-number').value;

            // IBTI Code Calculation
            const ibtiCodeHtml = topProfiles.map(p => {
                const profile = learnerProfiles[p[0]];
                return `<span style="color: ${profile.color}">${profile.code}</span>`;
            }).join('');
            document.getElementById('ibti-code').innerHTML = ibtiCodeHtml;

            // ìƒìœ„ 4ê°œ
            const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', 'ğŸ…'];
            const topProfilesHtml = topProfiles.map((profile, index) => {
                const profileData = learnerProfiles[profile[0]];
                return `
                    <div class="top-profile">
                        <div class="profile-info">
                            <div class="medal">${medals[index]}</div>
                            <div>
                                <div class="profile-name" style="color: ${profileData.color}">${profileData.emoji} ${profileData.name}</div>
                                <div class="profile-name-en">${profileData.nameEn}</div>
                                <div style="margin-top: 5px; font-size: 0.9em; color: #555;">${profileData.desc}</div>
                            </div>
                        </div>
                        <div class="profile-score">
                            <div class="score-number" style="color: ${profileData.color}">${profile[1]}%</div>
                            <div class="score-label">ì¼ì¹˜ë„</div>
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('top-profiles').innerHTML = topProfilesHtml;

            // ì „ì²´ ì ìˆ˜
            const allScoresHtml = Object.entries(scores)
                .sort((a, b) => b[1] - a[1])
                .map(([profileKey, score]) => {
                    const profileData = learnerProfiles[profileKey];
                    return `
                        <div class="score-item">
                            <div class="score-header">
                                <span>${profileData.emoji} ${profileData.name}</span>
                                <span>${score}%</span>
                            </div>
                            <div class="score-bar-container">
                                <div class="score-bar" style="width: ${score}%"></div>
                            </div>
                        </div>
                    `;
                }).join('');
            document.getElementById('all-scores').innerHTML = allScoresHtml;
        }

        // ë‹¤ì‹œ ì‹œì‘
        restartBtn.addEventListener('click', () => {
            currentQuestion = 0;
            answers = {};
            // í•™ìƒ ì •ë³´ëŠ” ìœ ì§€í• ì§€ ì´ˆê¸°í™”í• ì§€ ì„ íƒ (ì—¬ê¸°ì„œëŠ” ì´ˆê¸°í™”)
            studentName = '';
            studentGrade = '';
            studentClass = '';
            studentNumber = '';
            studentNameInput.value = '';
            studentGradeInput.value = '';
            studentClassInput.value = '';
            studentNumberInput.value = '';
            startBtn.disabled = true;
            resultScreen.classList.add('hidden');
            introScreen.classList.remove('hidden');
            
            // ì¡°íšŒ ëª¨ë“œì—ì„œ ëŒì•„ì™”ì„ ë•Œë¥¼ ìœ„í•´ ìŠ¤í¬ë¡¤ ìµœìƒë‹¨ìœ¼ë¡œ
            window.scrollTo(0, 0);
        });

        // --- ê²°ê³¼ ì¡°íšŒ ê¸°ëŠ¥ ---
        const searchModal = document.getElementById('search-modal');
        const searchBtn = document.getElementById('search-history-btn');
        const viewHistoryBtn = document.getElementById('view-history-btn'); // ë‹¤ë¥¸ ê²°ê³¼ ë³´ê¸° ë²„íŠ¼
        const closeSearchBtn = document.querySelector('.close-search');
        const doSearchBtn = document.getElementById('do-search-btn');

        // ëª¨ë‹¬ ì—´ê¸°
        searchBtn.addEventListener('click', () => {
            searchModal.style.display = 'block';
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”í•˜ì§€ ì•Šê³  ì´ì „ ì…ë ¥ê°’ ìœ ì§€ (í¸ì˜ì„±)
        });

        // ê²°ê³¼ í™”ë©´ì—ì„œ 'ë‹¤ë¥¸ ê²°ê³¼ ë³´ê¸°' í´ë¦­ ì‹œ
        viewHistoryBtn.addEventListener('click', () => {
            // í˜„ì¬ ë³´ê³  ìˆëŠ” í•™ìƒ ì •ë³´ë¡œ ê²€ìƒ‰ ëª¨ë‹¬ ì—´ê¸°
            document.getElementById('search-name').value = studentName;
            document.getElementById('search-grade').value = studentGrade;
            document.getElementById('search-class').value = studentClass;
            document.getElementById('search-number').value = studentNumber;
            
            searchModal.style.display = 'block';
            
            // ì •ë³´ê°€ ëª¨ë‘ ìˆë‹¤ë©´ ìë™ìœ¼ë¡œ ê²€ìƒ‰ ì‹¤í–‰
            if (studentName && studentGrade && studentClass && studentNumber) {
                 doSearchBtn.click();
            } else {
                // ì •ë³´ê°€ ë¶€ì¡±í•˜ë©´ ì•Œë¦¼ (ë””ë²„ê¹…ìš©)
                console.warn('í•™ìƒ ì •ë³´ ëˆ„ë½:', { studentName, studentGrade, studentClass, studentNumber });
                alert('í•™ìƒ ì •ë³´ê°€ ì¼ë¶€ ëˆ„ë½ë˜ì–´ ë‹¤ì‹œ ì…ë ¥ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        });

        // ëª¨ë‹¬ ë‹«ê¸°
        closeSearchBtn.addEventListener('click', () => {
            searchModal.style.display = 'none';
        });

        window.addEventListener('click', (e) => {
            if (e.target == searchModal) {
                searchModal.style.display = 'none';
            }
        });

        // ëª¨ë‹¬ ë‚´ìš© í´ë¦­ ì‹œ ë‹«í˜ ë°©ì§€
        document.querySelector('.search-modal-content').addEventListener('click', (e) => {
            e.stopPropagation();
        });

        // ê²€ìƒ‰ ì‹¤í–‰
        doSearchBtn.addEventListener('click', async () => {
            const name = document.getElementById('search-name').value.trim();
            const grade = document.getElementById('search-grade').value.trim();
            const sClass = document.getElementById('search-class').value.trim();
            const number = document.getElementById('search-number').value.trim();
            const resultArea = document.getElementById('search-result-area');
            const listContainer = document.getElementById('search-list-container');

            if (!name || !grade || !sClass || !number) {
                alert('ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const originalBtnText = doSearchBtn.textContent;
            doSearchBtn.textContent = 'ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';
            doSearchBtn.disabled = true;
            resultArea.style.display = 'none'; // ê¸°ì¡´ ê²°ê³¼ ìˆ¨ê¹€

            try {
                let foundResults = [];

                // 1. êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ ê²€ìƒ‰
                if (GOOGLE_SCRIPT_URL) {
                    try {
                        const queryParams = new URLSearchParams({
                            type: 'search',
                            name: name,
                            grade: grade,
                            class: sClass,
                            number: number
                        });
                        
                        const response = await fetch(`${GOOGLE_SCRIPT_URL}?${queryParams.toString()}`);
                        const data = await response.json();
                        
                        if (data && data.result === 'success' && data.data) {
                            // ë°°ì—´ì¸ì§€ í™•ì¸í•˜ê³  ì²˜ë¦¬
                            foundResults = Array.isArray(data.data) ? data.data : [data.data];
                        }
                    } catch (e) {
                        console.error('Google Sheet search failed:', e);
                    }
                }

                // 2. êµ¬ê¸€ ì‹œíŠ¸ì— ì—†ìœ¼ë©´ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ê²€ìƒ‰ (ë°±ì—…)
                if (foundResults.length === 0) {
                    const localHistory = JSON.parse(localStorage.getItem('ibTestResults') || '[]');
                    
                    foundResults = localHistory.filter(r => 
                        r.name === name && 
                        r.grade == grade && 
                        r.class == sClass && 
                        r.number == number
                    );
                }

                if (foundResults.length > 0) {
                    // ìµœì‹ ìˆœ ì •ë ¬
                    foundResults.sort((a, b) => new Date(b.date) - new Date(a.date));

                    // ëª©ë¡ ë Œë”ë§
                    listContainer.innerHTML = foundResults.map((result, index) => {
                        const date = new Date(result.date).toLocaleString('ko-KR');
                        // ì„ì‹œ ì¸ë±ìŠ¤ë¥¼ ë°ì´í„° ì†ì„±ìœ¼ë¡œ ì €ì¥
                        return `
                            <div class="search-result-item" onclick="selectSearchResult(${index})">
                                <div>
                                    <span class="result-date">${date}</span>
                                    <span class="result-type">${result.testType || 100}ë¬¸í•­</span>
                                </div>
                                <div class="result-arrow">ê²°ê³¼ ë³´ê¸° â”</div>
                            </div>
                        `;
                    }).join('');

                    // ì „ì—­ ë³€ìˆ˜ì— í˜„ì¬ ê²€ìƒ‰ ê²°ê³¼ ì €ì¥ (ì„ íƒ ì‹œ ì‚¬ìš©)
                    window.currentSearchResults = foundResults;

                    resultArea.style.display = 'block';
                } else {
                    alert('ì¼ì¹˜í•˜ëŠ” ê²€ì‚¬ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.\nì •ë³´ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.');
                }

            } catch (e) {
                console.error('Search error:', e);
                alert('ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                doSearchBtn.textContent = originalBtnText;
                doSearchBtn.disabled = false;
            }
        });

        // ê²€ìƒ‰ ê²°ê³¼ ì„ íƒ ì²˜ë¦¬
        window.selectSearchResult = function(index) {
            const result = window.currentSearchResults[index];
            if (!result) return;

            studentName = result.name;
            // ì „ì—­ ë³€ìˆ˜ì— ê²€ìƒ‰ëœ ì •ë³´ ì €ì¥ (ì¤‘ìš”!)
            studentGrade = result.grade;
            studentClass = result.class;
            studentNumber = result.number;
            
            // ìƒìœ„ 4ê°œ í”„ë¡œí•„ ì¬ê³„ì‚°
            let topProfiles = result.topProfiles;
            if (!topProfiles || topProfiles.length === 0) {
                topProfiles = Object.entries(result.scores)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 4);
            }

            searchModal.style.display = 'none';
            introScreen.classList.add('hidden');
            testScreen.classList.add('hidden');
            
            showResults(result.scores, topProfiles);
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('search-name').value = '';
            document.getElementById('search-grade').value = '';
            document.getElementById('search-class').value = '';
            document.getElementById('search-number').value = '';
            document.getElementById('search-result-area').style.display = 'none';
        };
    </script>
</body>
</html>